import{constructFrom as y,createMemo as u,createStateIfPrimitive as k,max as C,min as x,parseLengthUnit as H,shuffledDeque as W}from"./chunk-RLUFV3VX.js";var P=["left","top","right","bottom"],L=["aqua","aquamarine","antiquewhite","blue","brown","blueviolet","chartreuse","crimson","darkkhaki","darkorange","darksalmon","fuchsia","gold","green","orangered","yellow","yellowgreen"],R=W(L),j=class{children=[];constructor(o,e,s,g){let r=[o,e,s,g],l={};for(let p=0;p<4;p++){let n=P[p],c=r[p],[i,a]=k(c);this[n]=i,l[n]=a}this.set=l}getFreespaceChild(){let{children:o}=this;if(o.length>0)return o[0];let{left:e,top:s,right:g,bottom:r}=this,l=y(this,e,s,g,r);return o.push(l),l}splitChildLeft(o,e={}){e.left??=0,e.right??=0;let s=this.getFreespaceChild(),{left:g,top:r,right:l,bottom:p}=s,[n,c]=k(H(o)),[i,a]=k({...e,top:0,bottom:0}),m=u(t=>{let{left:f=0,right:b=0}=i(t);return x(g(t)+f,l(t)-b)}),_=u(t=>{let{left:f=0,right:b=0}=i(t),d=g(t)+f,M=C(l(t)-b,d),w=r(t),v=p(t),{px:F=0,pw:S=0,ph:q=0}=n(t);return x(d+F+(M-d)*S+(v-w)*q,M)}),h=y(this,m,r,_,p);return h.margin=i,h.width=n,h.set.margin=a,h.set.width=c,s.left=u(t=>x(_(t)+i(t).right,l(t))),this.children.push(h),h}splitChildTop(o,e={}){e.top??=0,e.bottom??=0;let s=this.getFreespaceChild(),{left:g,top:r,right:l,bottom:p}=s,[n,c]=k(H(o)),[i,a]=k({...e,left:0,right:0}),m=u(t=>{let{top:f=0,bottom:b=0}=i(t);return x(r(t)+f,p(t)-b)}),_=u(t=>{let{top:f=0,bottom:b=0}=i(),d=g(t),M=l(t),w=r(t)+f,v=C(p(t)-b,w),{px:F=0,pw:S=0,ph:q=0}=n(t);return x(w+F+(M-d)*S+(v-w)*q,v)}),h=y(this,g,m,l,_);return h.margin=i,h.height=n,h.set.margin=a,h.set.height=c,s.top=u(t=>x(_(t)+i(t).bottom,p(t))),this.children.push(h),h}splitChildRight(o,e={}){e.left??=0,e.right??=0;let s=this.getFreespaceChild(),{left:g,top:r,right:l,bottom:p}=s,[n,c]=k(H(o)),[i,a]=k({...e,top:0,bottom:0}),m=u(t=>{let{left:f=0,right:b=0}=i(t),d=g(t)+f,M=C(l(t)-b,d),w=r(t),v=p(t),{px:F=0,pw:S=0,ph:q=0}=n(t);return C(M-F-(M-d)*S-(v-w)*q,d)}),_=u(t=>{let{left:f=0,right:b=0}=i(t);return C(g(t)+f,l(t)-b)}),h=y(this,m,r,_,p);return h.margin=i,h.width=n,h.set.margin=a,h.set.width=c,s.right=u(t=>C(m(t)+i(t).left,g(t))),this.children.push(h),h}splitChildBottom(o,e={}){e.top??=0,e.bottom??=0;let s=this.getFreespaceChild(),{left:g,top:r,right:l,bottom:p}=s,[n,c]=k(H(o)),[i,a]=k({...e,left:0,right:0}),m=u(t=>{let{top:f=0,bottom:b=0}=i(t),d=g(t),M=l(t),w=r(t)+f,v=C(p(t)-b,w),{px:F=0,pw:S=0,ph:q=0}=n(t);return C(v-F-(M-d)*S-(v-w)*q,w)}),_=u(t=>{let{top:f=0,bottom:b=0}=i(t);return C(r(t)+f,p(t)-b)}),h=y(this,g,m,l,_);return h.margin=i,h.height=n,h.set.margin=a,h.set.height=c,s.bottom=u(t=>C(m(t)+i(t).top,r(t))),this.children.push(h),h}hit(o,e){if(this.left()<=o&&o<=this.right()&&this.top()<=e&&e<=this.bottom()){let s=this.children,g=s.length,r,l=0;for(;++l<g&&!(r=s[l].hit(o,e)););return r??this}}toString(){let{left:o,top:e,right:s,bottom:g,margin:r,width:l,height:p,set:n,children:c}=this,i=[],a={setters:i,position:[o(),e(),s(),g()]};for(let m in n)n[m]!==void 0&&i.push(m);if(r){let{left:m,top:_,right:h,bottom:t}=r();a.margin=[m,_,h,t]}return l&&(a.width=l()),p&&(a.height=p()),c.length>0&&(a.children=c.map(m=>m.toString())),a}toPreview(o,e){let s=this.children,g=s.length;if(g<=1||e){let{left:r,top:l,right:p,bottom:n}=this,c=r(),i=l(),a=p()-c,m=n()-i;o.fillStyle=e??R.next().value,o.fillRect(c,i,a,m)}for(let r=0;r<g;r++)s[r].toPreview(o,r===0?e??"gray":void 0)}};export{j as FrameSplit};
